<%# app/views/clients/_card_result.html.erb %>
<% overdue = client.next_payment_on.present? && client.next_payment_on < Date.current %>
<% active  = client.next_payment_on.present? && client.next_payment_on >= Date.current %>

<div class="card result-card" style="border: 4px solid <%= overdue ? '#ef4444' : '#34d399' %>; margin-top: 20px; animation: fadeIn 0.5s;">
  <div class="result-left">
    <div class="result-photo">
      <%= client_photo_tag(client, size: 160, classes: "client-photo--xl") rescue "" %>
    </div>

    <div class="result-details">
      <h3 class="result-name"><%= client.name %></h3>
      <p class="result-meta">#<%= client.id %> • <%= client.membership_type.presence || "Normal" %></p>

      <div class="result-kv">
        <span>Inscripción</span>
        <span><%= client.enrolled_on || "-" %></span>
      </div>
      <div class="result-kv">
        <span>Próximo pago</span>
        <span><%= client.next_payment_on || "-" %></span>
      </div>

      <div class="result-actions">
        <%= link_to "Ver ficha", client_path(client), class: "btn" %>
        <% if overdue %>
          <%= link_to "Renovar ahora", memberships_path(q: client.id), class: "btn btn-primary" %>
        <% end %>
      </div>
    </div>
  </div>

  <div class="result-right">
    <% if overdue %>
      <div class="status-panel status-panel--debt">
        <div class="status-kicker">Estado</div>
        <div class="status-big">ADEUDO</div>
        <p class="status-sub">La fecha de pago ya pasó.</p>
        <div class="status-buttons">
          <%= link_to "Renovar ahora", memberships_path(q: client.id), class: "btn btn-primary btn-lg" %>
        </div>
      </div>
    <% elsif active %>
      <div class="status-panel status-panel--ok">
        <div class="status-kicker">Estado</div>
        <div class="status-big">¡BIENVENIDO!</div>
        <p class="status-sub">Acceso concedido.</p>
        <div class="status-badge-row">
          <span class="status-badge status-badge--ok"><span class="dot"></span> Al día</span>
        </div>
      </div>
    <% else %>
      <div class="status-panel">
        <div class="status-kicker">Estado</div>
        <div class="status-big">SIN DATOS</div>
        <div class="status-buttons">
          <%= link_to "Registrar", memberships_path(q: client.id), class: "btn btn-accent btn-lg" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
<style> @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } } </style>